<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>

	<th:block th:fragment="dialog">

		<div class="row clearfix">
			<div class="col-md-12 column">

				<!--  <a id="modal-306690" href="#modal-container-306690" role="button" class="btn" data-toggle="modal" type="hidden"></a> -->
				<div class="modal fade" id="modal-container-306691" role="dialog"
					aria-labelledby="myModalLabel" aria-hidden="true">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-hidden="true">×</button>
								<h4 class="modal-title" id="myModalLabel">预计市场费备注<span class="add-marketfee-info"></span></h4>
							</div>
							<div class="modal-body">
								<form class="form-horizontal" role="form">
									<!-- 预计市场费备注 -->
									<div class="form-group">
										<label for="market-fee-comment" class="col-sm-2 control-label">备注</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" id="market-fee-comment"
												name="market-fee-comment"  th:value="${currOrder.marketFeeComment}"/>
										</div>
									</div>
								</form>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-default"
									data-dismiss="modal">关闭</button>
								<button type="button" class="btn btn-primary"
									id="btn-save-market-fee-comment">保存</button>
							</div>
						</div>

					</div>

				</div>

			</div>
		</div>

	</th:block>
	
	<script th:inline="javascript">
	/*<![CDATA[*/
	    var curr_order=[[${currOrder}]];	//当前的订单
	/*]]>*/
	</script>
	
	<script type="text/javascript">
	
	
	
	//-------------------前端数据操作------------------
	/**
	 * 返回绑定用户列表(自服务器返回的参数)
	 */
	function getCurrOrder(){
		return curr_order;
	}
	
	//------------------业务操作----------------------
	/**
	 * 保存预计市场费用备注:save
	 * @returns
	 */
	function saveMarketFeeComment(){
		var urlStr = BASE_CONTEXT_PATH + "/back/marketfee/savemarketfeecomment"; // 需要提交的url
		
		/*var params=new Object();  //生成参数对象.
		
		params.agentId=agentId;
		params.userList=userList;*/
		
		var orderId=curr_order.id;
		var orderNo=curr_order.orderId;
		
		//自对话框中取得所输入的值
		/* var itemType=$('#accountItemType').val();
		var amount=$('#amount').val(); */
		var marketFeeComment=$('#market-fee-comment').val();
		//console.log("marketFeeComment:"+marketFeeComment);
		
		$.ajax({
			type : "POST", // 提交方式 get/post
			url : urlStr,
			//contentType : "application/json", // 如果采用json格式传送所有参数时必须有,如果采普通js对象传送时,则不可以加此参数
			//dataType : "html", //表示返回值类型，不必须,如果返回的是面页，则必须
			data : {
				'orderId':orderId,
				'orderNo':orderNo,				
				'marketFeeComment':marketFeeComment				
			},
			success : function(res) { // data 保存提交后返回的数据，一般为 json 数据
				//console.log(res);
				if (res != null && res != "") {
					var obj = $.parseJSON(res);
					if (obj.result_code == "success") {
						//util.message(obj.result_msg);																
						closeModiMarketFeeCommentDialog();
					} else {
						util.message(obj.result_msg);
					}
				}
			},
			error : function(jqXHR, textStatus, errorThrown) {
				util.message("AJAX请求时发生错误!");
				/* 弹出jqXHR对象的信息 */
				console.log(jqXHR.responseText);
				console.log(jqXHR.status);
				console.log(jqXHR.readyState);
				console.log(jqXHR.statusText);
				/* 弹出其他两个参数的信息 */
				console.log(textStatus);
				console.log(errorThrown);

			}
		});
	}
	
	
	$(function(){
		
		
		//保存市场费备注
		$('#btn-save-market-fee-comment').on('click',function(){		
			saveMarketFeeComment();
		})
		
		
	});
		
	
	</script>

</body>
</html>