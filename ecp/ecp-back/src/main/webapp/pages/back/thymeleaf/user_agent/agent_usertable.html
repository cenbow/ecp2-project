<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<table class="table">
		<thead>
			<tr>
				<th>ID</th>
				<th>登录名称</th>
				<th>昵称</th>
				<th>主帐号</th>
				<th>操作</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="item: ${userList}">
				<td th:text="${item.id}">条目ID</td>
				<td th:text="${item.username}">登录名称</td>
				<td th:text="${item.nickname}">登录名称</td>

				<td><span th:if="${item.parent_id==null or item.parent_id==0}"
					th:remove="tag"> <span>主帐号</span>
				</span></td>

				<!-- 操作 -->
				<td>
					<a type="button" class="modi-user" th:attr="data-bind-userid=${item.id},data-bind-username=${item.username},data-bind-nickname=${item.nickname}"> 
						<i	class=" icon-edit icon-large" style="color: darkblue" title="修改用户"></i>
					</a> 
					<a type="button" class="del-user" th:attr="data-bind-userid=${item.id},data-bind-username=${item.username},data-bind-nickname=${item.nickname}"> 
						<i class=" icon-remove-circle icon-large" style="color: darkblue" title="删除用户"></i>
					</a> 
					<a type="button" class="set-primary-user" th:attr="data-bind-userid=${item.id},data-bind-username=${item.username},data-bind-nickname=${item.nickname}"> 
						<i	class=" icon-tag icon-large" style="color: darkblue" title="设置主帐号"></i>
					</a> 
					<!-- <a type="button" class="reset-password" th:attr="data-bind-userid=item.id,data-bind-username=item.useranme,data-bind-nickname=item.nickname"> 
						<i class="icon-retweet icon-large" style="color: darkblue"	title="重置密码"></i>
					</a> -->
				</td>
			</tr>
		</tbody>
	</table>

	<script th:inline="javascript">  
		/*<![CDATA[*/
		var curr_agentId = [[${agentId}]];  //回传的当前代理商ID
		/*]]>*/
	</script>


	<script type="text/javascript">
		
		/**
		 *				         重置帐号口令 
		 * @param agentId  签约客户ID
		 * @param userId 签约客户分配的用户ID
		 * @returns 
		 */
		/* function resetPassword(userId) {
			var url = BASE_CONTEXT_PATH + "/back/agent/reset_password"; // 需要提交的 url
			$.ajax({
				type : "post", // 提交方式 get/post
				url : url, // 需要提交的 url
				// dataType: "application/json",
				data : {
					'userId' : userId
				},
				success : function(res) { // data 保存提交后返回的数据，一般为 json 数据
					console.log(res);
					if (res != null && res != "") {
						var obj = $.parseJSON(res);
						if (obj.result_code == "success") {
							util.message(obj.result_msg);
						} else {
							util.message(obj.result_err_msg);
						}
					}
				}
	
			});
		} */
		
	
		$(function(){
			//修改用户
			$('.modi-user').on('click', function() {
				var defaultPassword = "123456";

				g_editMode=EDIT_MODE_MODI;  	//设置编辑模式
				
				//$("#dispatch-form").reset;  	//清空所有编辑框
				document.getElementById("dispatch-form").reset(); 
				
				//设置对话框中显示的内容
				var companyName=$("#curr-companyName").text();
				$("#myModalLabel").text("公司名称:" + companyName+"(修改帐号)");
				
				//$("#password").val(defaultPassword);//默认的帐户密码是：123456
				$(".password-desc").text(defaultPassword);  //显示:默认的口令说明
				
				//读取当前用户的信息
				var userId=$(this).attr("data-bind-userid");
				var userName=$(this).attr("data-bind-username");
				var nickName=$(this).attr("data-bind-nickname");
				//将当前用户的信息置于对话框中.
				$("#loginName").val(userName);
				$("#loginName").attr("readonly","readonly");  //设置登录帐号为只读属性.
				$("#nickName").val(nickName);
				//设置当前编辑的用户ID.对话框中隐藏字段
				$("#modi-user-id").val(userId);
				
				//显示编辑帐号对话框
				displayWindow();
			})
	
			//删除用户
			$('.del-user').on('click', function() {
				console.log("delete user");
			})
			
			//设置主帐号
			$('.set-primary-user').on('click', function() {
				console.log("set primary user");
			})
			
			//重置帐号口令 
			/* $(".reset-password").on("click", function(e) {
				var agentId = $(this).attr("data-bind");
				var userId = $(this).attr("data-user-id");
				var accountState = $(this).attr("data-account-state");
				if (userId == 0) {
					util.message("尚未分配帐号！");
				} else {
					if (accountState == 2) {
						util.message("此帐号己为无效,无需重置口令！");
					} else {
						//显示提示对话框(是否重置口令)
						util.confirm("确认重置口令?", userId, "resetPassword", "");
						//resetPassword(agentId, userId);
					}
				}
	
			}); */
	
			
			
		});
		
	</script>
</body>
</html>